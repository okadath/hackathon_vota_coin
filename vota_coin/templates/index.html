{% load static %}

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Creative Tim">
  <title>Spanish Link</title>
  <!-- Extra details for Live View on GitHub Pages -->
  <!-- Canonical SEO -->
  <!--  Social tags      -->


  <!-- <script src="js/require.js"></script> -->
  <!-- Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
  <!-- Icons -->
<!--     <link rel="stylesheet" href="{% static 'assets/vendor/nucleo/css/nucleo.css' %}" type="text/css">
    <link rel="stylesheet" href="{% static 'assets/vendor/fontawesome/fontawesome-free/css/all.min.css' %}" type="text/css">
 
    <link rel="stylesheet" href="  {% static 'assets/css/argon.min.css' %}" type="text/css">
    Google Tag Manager -->
    <!-- <script src="./dist/bundle.js" type="module"></script> -->

    <!-- <script type="module" src="index.js"></script>  -->
    <!-- End Google Tag Manager -->
  </head>

  <body class="bg-gradient-white">
    <!-- Google Tag Manager (noscript) -->
    <!-- End Google Tag Manager (noscript) -->
    <!-- Navbar -->


    <!-- mi mierda -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-carousel@4.0.3/dist/css/bulma-carousel.min.css"> -->

    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0"
    crossorigin="anonymous">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script> -->
    <!-- <script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script> -->
    {% include './navbar.html' %}

    <section class="section">
      <div class="container">
        <h1 class="title">
          Vota Demo
        </h1>
        <nav class="panel">
          <p class="panel-heading">
            Votation(Holders)
          </p>
          {% if error_messages %}
          <div class="alert alert-danger">
            <strong>{{ error_messages }}</strong>
          </div>
          {% endif %}
          <!-- <form method="post" action="{% url 'login_func' %}"> -->
            <!-- {% csrf_token %} -->
            <div class="panel-block">
              <div class="field">

<!--                 <div class="field is-grouped">
                  <div class="control">  
                    <button  type="submit" class="button is-success enableEthereumButton"> Enable Ethereum</button>
                    <button class="sendEthButton button is-info">Send Eth</button>

                    <h2>Account: <span class="showAccount"></span></h2>
                  </div>
                  <br> -->
                  <div class="field is-grouped">
                    <div class="control">  
                  <button id="connectButton" class="button is-info" onclick="bundle.connect()">Connect</button>
                  <button id="executeButton" class="button is-success" onclick="bundle.get_balance()">Get Balance of Vota_token</button>

                  <a href="{% url 'get_votations' 'a'%} " class="btn btn-primary is is-success">Vote</a> 
                  <a href="{% url 'create_votation' %} " class="btn btn-primary is is-info">Create votation</a> 
                  <br>
                  Only holders can vote, You must have more of 100 Vota_token to vote, the tokens are not locked but must have in your metamask account for voting
                  <h5>Balance Account: <span class="showAccount"></span></h5> 
                </div>
                </div>

                   <div class="field is-grouped">   
                <!-- <main class="cards"> -->
                  <div >
                    <div id="test12" class="control" style="display: flex; flex-direction: row; flex-wrap: wrap">
                      
                    </div>
                  </div>
                <!-- </main> --> 
              </div>


                
              </div>
            </div>
            <!-- </form> -->
          </nav>


<script type="text/javascript">

//  function votation_list(){
//   const a= [
// { category: "Material", id: '1', name: 'Brakedown of machine' },
// { category: "Material", id: '2', name: 'Brakedown of machine' },
// { category: "Tool", id: '3', name: 'Brakedown of machine' },
// { category: "Tool", id: '4', name: 'Brakedown of line' },
// { category: "Tool", id: '5', name: 'Brakedown of machine' },
// { category: "Tool", id: '6', name: 'Brakedown of line' },
// { category: "Tool", id: '7', name: 'Brakedown of machine' },
// { category: "Tool", id: '8', name: 'Brakedown of line' }
// ];
// return a;
// }



//   $(document).ready(function(){
// var mokData = votation_list();
// $.each(mokData, function (i) {
//     var templateString = 
//     ' <div class="card" style="width: 18rem; margin: 10px"> <div ><article class="card"><h2>' 
//     + mokData[i].category + '</h2><p>'
//      + mokData[i].name + '</p><p>'
//       + mokData[i].id 
//       + '</p><button id="tes">Start</button></article></div></div>';

//     $('#test12').append(templateString);
// })

// $("#tes").on("click", function () {
//     alert("test");
// });
// });


</script>
          <!-- in server -->
          <script src="/static/bundle.js" type="module"></script>
          <!-- in local js -->
          <!-- <script src="./dist/bundle.js" type="text/javascript"></script> -->

          <nav class="panel">
            <p class="panel-heading">
              Votation(Registred users)
            </p>
            {% if error_messages %}
            <div class="alert alert-danger">
              <strong>{{ error_messages }}</strong>
            </div>
            {% endif %}

            {% if user.is_authenticated %}
            <br>
            <div class="panel-block">
              <div class="field">
                <h5> {{user.email}} </h5>
              </div>
            </div>
            <form method="post" action="{% url 'login_func' %}">
              {% csrf_token %}
              <div class="panel-block">
                <div class="field">



                  <div style="display: flex; flex-direction: row; flex-wrap: wrap">
                    {% for card in votings %} 
                    <div class="card" style="width: 18rem; margin: 10px"> 
                      <div class="card-body">
                        <div style="display: flex; flex-direction: row">
                          <h5 class="card-title">{{ card.name }}</h5> 
                        </div>
                        <p class="card-text">{{ card.description }}</p>
                        <p>Votes(with registry):{{card.points}}</a>

                          <!-- <p>Votos libres:{{card.points_free}}</a> -->
                            <br>
                            <a href="{% url 'registred_vote'  card.id  0%} " class="btn btn-primary">Vote</a> 
                        </div>
                      </div>
                      {% endfor %}

                    </div>





                    </div>
                  </div>
                </form>



                {% else %}
                <form method="post" action="{% url 'login_func' %}">

                  {% csrf_token %}
                   Testing Account User:vintaw.01@gmail.com Password:qweqwe35$

                  <div class="panel-block">
                    <div class="field">
                      <label class="label">Email</label>
                      <div class="control has-icons-left has-icons-right">
                        <input class="input is-success" type="email" placeholder="Email" name="id_email" id="id_email" >
                        <span class="icon is-small is-left">
                          <i class="fas fa-user"></i>
                        </span>
                      </div>

                      <label class="label">Password</label>
                      <div class="control has-icons-left has-icons-right">
                        <input class="input is-success" type="password" placeholder="Password" name="id_password" id="id_password" >
                        <span class="icon is-small is-left">
                          <i class="fas fa-lock"></i>
                        </span>
                      </div>
                      <br>
                      <div class="field is-grouped">
                        <div class="control"> 
                          <button class="button is-link" type="submit" >Login</button>
                          <button class="button is-success" type="submit"  disabled> Sign In</button>

                        </div>
                        <br>

                      </div>

                    </div>
                  </div>
                </form>
                {% endif %}
              </nav>







              <nav class="panel">
                <p class="panel-heading">
                  Votation(Free)
                </p>
                {% if error_messages %}
                <div class="alert alert-danger">
                  <strong>{{ error_messages }}</strong>
                </div>
                {% endif %}
                <form method="post" action="{% url 'login_func' %}">
                  {% csrf_token %}
                  <div class="panel-block">
                    <div class="field">



                      <div style="display: flex; flex-direction: row; flex-wrap: wrap">
                        {% for card in votings %} 
                        <div class="card" style="width: 18rem; margin: 10px"> 
                          <div class="card-body">
                            <div style="display: flex; flex-direction: row">
                              <h5 class="card-title">{{ card.name }}</h5> 
                            </div>
                            <p class="card-text">{{ card.description }}</p>
                            <!-- <p>Votos con registro:{{card.points}}</a> -->

                              <p>Votes:{{card.points_free}}</a>
                                <br>
                                <a href="{% url 'free_vote'  card.id %} " class="btn btn-primary">Vote</a>
                                <!-- <a href="/command/{{ card.id }}/delete" class="btn btn-primary">Delete</a> -->
                              </div>
                            </div>
                            {% endfor %}

                          </div>





                        </div>
                      </div>
                    </form>

                  </nav>

                </div>
              </section>


              <script type="text/javascript">
                if (typeof window.ethereum !== 'undefined') {
                  console.log('MetaMask is installed!');
                }
                else{
                  console.log('install MetaMask!');
                }

              </script>


              <!-- <script type="module" src="./static/src.a2b27638.js"></script>  -->



              </html>


